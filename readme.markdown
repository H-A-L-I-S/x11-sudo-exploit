Almost all code is from https://github.com/anko/xkbcat with small adjustments to exploit x11

# What is this
This is a simple proof-of-concept shows that x11 or xorg breaks sudo security feature in linux. In this example the exploit captures the users sudo password and uses that password to open a terminal as root. The user run a unrelated sudo command like `sudo apt update` in another window. However the exploit can also be used to run harmful commands with root privilages without any limitation (for example `sudo rm -rf /* --no-preserve-root`), by just changing the relevant [line](https://github.com/H-A-L-I-S/x11-sudo-exploit/blob/071c68601260b8b146e54ef349cb0052cf647900/xkbcat.c#L65) in the code. More details, why x11 is unsecure by design: \
  [Stackexchange explanation](https://security.stackexchange.com/a/4646) \
  [A blog post of 2015](https://blog.martin-graesslin.com/blog/2015/11/looking-at-the-security-of-plasmawayland/) \
  [linuxiac.com very detailed explanation](https://linuxiac.com/xorg-x11-wayland-linux-display-servers-and-protocols-explained/)


# How to use
 Just run the executable file and run in another terminal a sudo command:

https://user-images.githubusercontent.com/60317617/145741681-f3ae06fa-4296-4e59-a045-8837604edafc.mp4


# Mitigation
* Switch to wayland

# Note
* This is a basic proof-of-concept. I did not make it work with special characters or backspace-key. However it is a simple task to make it work with these.
* x11 just looks horribile. So I did not spend any time to make this code any readable.
